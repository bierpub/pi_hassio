- id: sun_room_door_open
  alias: "Sun Room Door Open"
  initial_state: true
  trigger:
    platform: state
    entity_id: 
      - sensor.sun_room_door_alarm_level
    from: "0"
    to: "255"
  condition:
  - condition: and
    conditions:
      - condition: template
        value_template: "{{ states('device_tracker.fa75j0303575') != 'home' }}"
      - condition: template
        value_template: "{{ states('device_tracker.rachel_iphone') != 'home' }}"
      - condition: template
        value_template: "{{ states('device_tracker.rachelsiphone') != 'home' }}"
  action:
    - service: notify.ios_rachel_iphone
      data:
        title: 'Sun Room Door is Open'
        message: 'Someone opened the Sun Room Door at {{now().strftime("%H:%M:%S")}}'
    - service: notify.mypushbullet
      data:
        title: 'Sun Room Door Open'
        message: 'The Sun Room Door was opened at {{now().strftime("%H:%M:%S")}}'

- id: front_door_open
  alias: "Front Door Open"
  initial_state: true
  trigger:
    platform: state
    entity_id: 
      - sensor.front_door_alarm_level
    from: "0"
    to: "255"
  condition:
  - condition: and
    conditions:
      - condition: template
        value_template: "{{ states('device_tracker.fa75j0303575') != 'home' }}"
      - condition: template
        value_template: "{{ states('device_tracker.rachel_iphone') != 'home' }}"
      - condition: template
        value_template: "{{ states('device_tracker.rachelsiphone') != 'home' }}"
  action:
    - service: notify.mypushbullet
      data:
        title: 'Front Door Open'
        message: 'The Front Door was opened at {{now().strftime("%H:%M:%S")}}'

- id: den_door_open
  alias: "Den Door Open"
  initial_state: true
  trigger:
    platform: state
    entity_id: 
      - sensor.den_door_alarm_level
    from: "0"
    to: "255"
  condition:
  - condition: and
    conditions:
      - condition: template
        value_template: "{{ states('device_tracker.fa75j0303575') != 'home' }}"
      - condition: template
        value_template: "{{ states('device_tracker.rachel_iphone') != 'home' }}"
      - condition: template
        value_template: "{{ states('device_tracker.rachelsiphone') != 'home' }}"
  action:
    - service: notify.mypushbullet
      data:
        title: 'Den Door Open'
        message: 'The Den Door was opened at {{now().strftime("%H:%M:%S")}}'

- id: garage_entry_open
  alias: "Garage Entry Open"
  initial_state: true
  trigger:
    platform: state
    entity_id: 
      - sensor.garage_entry_alarm_level
    from: "0"
    to: "255"
  condition:
  - condition: and
    conditions:
      - condition: template
        value_template: "{{ states('device_tracker.fa75j0303575') != 'home' }}"
      - condition: template
        value_template: "{{ states('device_tracker.rachel_iphone') != 'home' }}"
      - condition: template
        value_template: "{{ states('device_tracker.rachelsiphone') != 'home' }}"
  action:
    - service: notify.mypushbullet
      data:
        title: 'Garage Entry Door Open'
        message: 'The Garage Entry Door was opened at {{now().strftime("%H:%M:%S")}}'

- id: test_door_open
  alias: "Test Door Open"
  initial_state: false
  trigger:
    platform: state
    entity_id: 
      - sensor.test_door_alarm_level
    from: "0"
    to: "255"
  condition:
  - condition: and
    conditions:
      - condition: template
        value_template: "{{ states('device_tracker.fa75j0303575') != 'home' }}"
      - condition: template
        value_template: "{{ states('device_tracker.rachel_iphone') != 'home' }}"
      - condition: template
        value_template: "{{ states('device_tracker.rachelsiphone') != 'home' }}"
  action:
    - service: notify.mypushbullet
      data:
        title: 'Test Door Open'
        message: 'The Test Door was opened at {{now().strftime("%H:%M:%S")}}'

- id: garage_opened
  alias: "Garage Opened"
  initial_state: true
  trigger:
    platform: state
    entity_id: 
      - sensor.garagedoor_status
    to: "Open"
  action:
    - service: notify.ios_rachel_iphone
      data:
        title: 'Garage Opened'
        message: 'Garage opened now at {{now().strftime("%H:%M:%S")}}'
    - service: notify.mypushbullet
      data:
        title: 'Garage Opened'
        message: 'Garage opened now at {{now().strftime("%H:%M:%S")}}'

- id: garage_closed
  alias: "Garage Closed"
  initial_state: true
  trigger:
    platform: state
    entity_id: 
      - sensor.garagedoor_status
    to: "Closed"
  action:
    - service: notify.ios_rachel_iphone
      data:
        title: 'Garage Closed'
        message: 'Garage closed now at {{now().strftime("%H:%M:%S")}}'
    - service: notify.mypushbullet
      data:
        title: 'Garage Closed'
        message: 'Garage closed now at {{now().strftime("%H:%M:%S")}}'

- id: garage_open_long
  alias: "Garage Open Long"
  initial_state: true
  trigger:
    platform: state
    entity_id: 
      - sensor.garagedoor_status
    to: "Open"
    for:
      minutes: 30
  action:
    - service: notify.ios_rachel_iphone
      data:
        title: 'Garage Open for 30'
        message: 'Garage has been open for 30 minutes'
    - service: notify.mypushbullet
      data:
        title: 'Garage Open for 30'
        message: 'Garage has been open for 30 minutes'

- id: garage_open_late
  alias: "Garage Open Late"
  initial_state: true
  trigger:
    platform: time
    at: '22:30:00'
  condition:
    - condition: state
      entity_id: sensor.garagedoor_status
      state: "Open"
  action:
    - service: notify.ios_rachel_iphone
      data:
        title: 'Garage Open at 10:30pm'
        message: 'Garage is still open at 10:30pm'
    - service: notify.mypushbullet
      data:
        title: 'Garage Open at 10:30pm'
        message: 'Garage is still open at 10:30pm'

- id: garage_open_midnight
  alias: "Garage Open Midnight"
  initial_state: true
  trigger:
    platform: time
    at: '00:00:00'
  condition:
    - condition: state
      entity_id: sensor.garagedoor_status
      state: "Open"
  action:
    - service: notify.ios_rachel_iphone
      data:
        title: 'Garage Open at Midnight'
        message: 'Garage is still open at Midnight!'
    - service: notify.mypushbullet
      data:
        title: 'Garage Open at Midnight'
        message: 'Garage is still open at Midnight!'
